// Organization-related models

model Organization {
  id        String   @id @default(cuid())
  name      String
  slug      String   @unique
  avatarId  String?  @map("avatar_id")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // Relations
  members      OrganizationMember[]
  sessions     Session[]
  todos        Todo[]
  invitations  OrganizationInvitation[]
  subscription Subscription?

  @@index([slug])
  @@map("organizations")
}

enum MemberRole {
  owner
  admin
  member
}

model OrganizationMember {
  id             String     @id @default(cuid())
  userId         String     @map("user_id")
  organizationId String     @map("organization_id")
  role           MemberRole @default(member)
  createdAt      DateTime   @default(now()) @map("created_at")
  updatedAt      DateTime   @updatedAt @map("updated_at")

  // Relations
  user         User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@unique([userId, organizationId])
  @@index([userId], map: "idx_org_members_user")
  @@index([organizationId], map: "idx_org_members_org")
  @@map("organization_members")
}
